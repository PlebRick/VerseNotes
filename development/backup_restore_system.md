# VerseNotes Backup & Restore System

## Overview

The VerseNotes backup and restore system provides comprehensive data management capabilities with multiple export formats and full import functionality. This system ensures users can safely backup their Bible study notes and restore them across devices.

## Features

### üîÑ **Complete Backup/Restore**
- **Full data backup** including notes, user settings, and metadata
- **Import conflict resolution** with replace vs merge options
- **Data integrity validation** with checksums and structure verification
- **Cross-platform compatibility** (web, iOS, Android)

### üìÑ **Multiple Export Formats**
- **JSON**: Complete backup with import capability
- **Markdown**: Readable format for sharing and documentation
- **Plain Text**: Universal compatibility format

### üõ°Ô∏è **Data Safety**
- **Validation checks** before import
- **Confirmation dialogs** for destructive operations
- **Detailed progress reporting** with import/skip counts
- **Error handling** with user-friendly messages

## Export Formats

### JSON Export (Backup)
```json
{
  "backup_info": {
    "version": "1.0.0",
    "app_version": "0.2.1",
    "created_date": "2024-01-15T10:30:00Z",
    "platform": "web",
    "notes_count": 5
  },
  "user_data": {
    "id": "default_user",
    "name": "User",
    "email": "",
    "settings": {
      "default_translation": "WEB",
      "font_size": "medium",
      "theme": "light",
      "auto_save": true,
      "verse_numbers": true,
      "paragraph_breaks": true,
      "notifications": true
    },
    "created_date": "2024-01-15T10:30:00Z",
    "updated_date": "2024-01-15T10:30:00Z"
  },
  "notes": [
    {
      "id": "note_123",
      "title": "Romans 1:1-7 Apostle Paul: The Model Missionary",
      "content": "<p>Introduction to the Book of Romans</p>",
      "verse_reference": "Romans 1",
      "start_verse": 1,
      "end_verse": 7,
      "tags": ["Romans", "Paul"],
      "created_date": "2024-01-15T10:30:00Z",
      "updated_date": "2024-01-15T10:30:00Z"
    }
  ],
  "checksum": {
    "notes_hash": "base64_encoded_hash",
    "settings_hash": "base64_encoded_hash"
  }
}
```

### Markdown Export
```markdown
# VerseNotes Export

**Export Date:** January 15, 2024
**Notes Count:** 2
**Translation:** WEB (World English Bible)

---

# Romans 1:1-7 Apostle Paul: The Model Missionary

**Scripture:** Romans 1:1-7
**Date:** July 13, 2025
**Tags:** #Romans, #Paul

## Scripture Text

**[1]** Paul, a servant of Jesus Christ, called to be an apostle, set apart for the Good News of God,

**[2]** which he promised before through his prophets in the holy Scriptures,

## Study Notes

Introduction to the Book of Romans
Its effect on history
Augustine
Luther
Wesley

---

*Generated by VerseNotes v0.2.1*
*2 notes exported on 2024-01-15*
```

### Plain Text Export
```
VERSENOTES EXPORT
==================================================

Export Date: January 15, 2024
Notes Count: 2
Translation: WEB (World English Bible)

==================================================

1. ROMANS 1:1-7 APOSTLE PAUL: THE MODEL MISSIONARY
---------------------------------------------------

Scripture: Romans 1:1-7
Date: July 13, 2025
Tags: Romans, Paul

SCRIPTURE TEXT:
[1] Paul, a servant of Jesus Christ, called to be an apostle, set apart for the Good News of God,

[2] which he promised before through his prophets in the holy Scriptures,

STUDY NOTES:
Introduction to the Book of Romans
Its effect on history
Augustine
Luther
Wesley

==================================================

Generated by VerseNotes v0.2.1
2 notes exported on 2024-01-15
```

## Usage Instructions

### Exporting Data

1. **Navigate to Settings** ‚Üí Data Management
2. **Select Export Format**:
   - **JSON**: For backup and import
   - **Markdown**: For sharing and documentation
   - **Plain Text**: For universal compatibility
3. **Click Export** button
4. **File Download/Share**:
   - **Web**: Automatic download to Downloads folder
   - **Mobile**: Native sharing dialog

### Importing Data (JSON Only)

1. **Navigate to Settings** ‚Üí Data Management
2. **Click Import** button
3. **Choose Import Mode**:
   - **Replace All**: Deletes existing data and restores from backup
   - **Merge**: Adds new notes, preserves existing ones
4. **Select Backup File** (JSON format)
5. **Confirm Import** and review results

### Import Conflict Resolution

#### Replace Mode
- **Deletes all existing notes** and settings
- **Restores complete backup** including user settings
- **Requires confirmation** due to destructive nature
- **Use case**: Full restore on new device

#### Merge Mode
- **Preserves existing notes** and settings
- **Adds new notes** from backup
- **Skips duplicate notes** (by ID)
- **Optional settings import** with user choice
- **Use case**: Combining data from multiple sources

## Technical Implementation

### Data Validation
- **Structure validation** for all required fields
- **Type checking** for arrays, objects, and primitives
- **Checksum verification** for data integrity
- **Version compatibility** checking

### Cross-Platform Support
- **Web**: Browser File API with blob downloads
- **Mobile**: Expo DocumentPicker and FileSystem
- **Consistent UX** across all platforms
- **Error handling** for platform-specific issues

### Bible Verse Integration
- **Automatic fetching** from bible-api.com
- **WEB translation** consistency
- **Error handling** for network issues
- **Fallback messaging** when verses unavailable

### File Naming Convention
- **JSON**: `versenotes_backup_YYYY-MM-DD.json`
- **Markdown**: `versenotes_export_YYYY-MM-DD.md`
- **Plain Text**: `versenotes_export_YYYY-MM-DD.txt`

## Error Handling

### Common Error Scenarios
1. **Invalid file format**: Clear error message with format requirements
2. **Network issues**: Graceful degradation for Bible verse fetching
3. **Storage issues**: Platform-specific error handling
4. **Validation failures**: Detailed error messages with fix suggestions

### User Feedback
- **Loading states** during export/import operations
- **Progress indicators** for long-running operations
- **Success messages** with operation summaries
- **Error messages** with actionable information

## Testing Scenarios

### Export Testing
- [x] JSON export with complete backup structure
- [x] Markdown export with Bible verse integration
- [x] Plain Text export with clean formatting
- [x] Cross-platform file download/sharing
- [x] Error handling for network issues

### Import Testing
- [x] Valid JSON import with data restoration
- [x] Invalid file format handling
- [x] Replace mode with complete restoration
- [x] Merge mode with duplicate handling
- [x] Settings import confirmation
- [x] Error handling for corrupted files

### UI Testing
- [x] Format selector functionality
- [x] Loading states and progress indicators
- [x] Confirmation dialogs
- [x] Success/error message display
- [x] Cross-platform compatibility

## Security Considerations

### Data Privacy
- **Local processing**: All data processing happens locally
- **No cloud storage**: Files are generated and stored locally
- **User control**: Users manage their own backup files

### Data Integrity
- **Checksums**: Verify data integrity during import
- **Validation**: Comprehensive structure validation
- **Confirmation**: Required for destructive operations

## Future Enhancements

### Potential Features
- **Encrypted backups** with password protection
- **Cloud storage integration** (Google Drive, iCloud)
- **Selective import** (choose specific notes)
- **Backup scheduling** with automatic exports
- **Version history** with multiple backup versions

### Format Extensions
- **PDF export** with formatted layout
- **Word document** export for printing
- **CSV export** for spreadsheet analysis
- **HTML export** for web viewing

## Troubleshooting

### Common Issues
1. **Export not working**: Check platform compatibility and permissions
2. **Import fails**: Verify file format and structure
3. **Bible verses missing**: Check network connection
4. **File not found**: Verify file location and permissions

### Support Information
- **App Version**: v0.2.1
- **Backup Format Version**: 1.0.0
- **Supported Platforms**: Web, iOS, Android
- **Required Permissions**: File system access for mobile

---

*Last Updated: January 15, 2024*
*System Version: 1.0.0* 